<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creative Calling â€” A Quiet Path Home</title>
  <link rel="stylesheet" href="assets/css/site.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:wght@400;600&display=swap');
    
    :root {
      --background: #1a1a1a;
      --bg: #2f2f2f;
      --text-main: #e6e6e6;
      --text-muted: #b0b0b0;
      --accent: #8aa7a1;
      --accent-dark: #7a9791;
      --border: #404040;
    }
    
    body {
      font-family: "Source Serif 4", Georgia, "Times New Roman", serif;
      background-color: var(--bg);
      color: var(--text-main);
      max-width: 900px;
      margin: 0 auto;
      padding: 0 1rem;
      line-height: 1.6;
    }

    h1, h2, h3 {
      font-family: Georgia, "Times New Roman", serif;
      color: var(--text-main);
    }

    h1 { font-size: 2.5rem; margin-bottom: 1rem; }
    h2 { font-size: 1.5rem; margin-bottom: 1rem; }
    h3 { font-size: 1.25rem; margin-bottom: 0.75rem; }

    .muted {
      color: var(--text-muted);
    }

    .text-center {
      text-align: center;
    }
    
    .text-lg {
      font-size: 1.125rem;
    }
    
    .text-4xl {
      font-size: 2.25rem;
    }
    
    .text-2xl {
      font-size: 1.5rem;
    }
    
    .text-xl {
      font-size: 1.25rem;
    }
    
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-8 { margin-top: 2rem; }
    .mt-12 { margin-top: 3rem; }
    .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
    .py-12 { padding-top: 3rem; padding-bottom: 3rem; }
    .py-20 { padding-top: 5rem; padding-bottom: 5rem; }
    .pt-8 { padding-top: 2rem; }
    .p-4 { padding: 1rem; }
    
    .space-y-2 > * + * { margin-top: 0.5rem; }
    .space-y-4 > * + * { margin-top: 1rem; }
    .space-y-6 > * + * { margin-top: 1.5rem; }
    .space-y-8 > * + * { margin-top: 2rem; }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding-left: 1rem;
      padding-right: 1rem;
    }
    
    .section {
      padding: 2rem 0;
      border-bottom: 1px solid var(--border);
    }
    
    .btn {
      background-color: var(--accent);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 0.5rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: all 0.2s;
    }
    
    .btn:hover {
      background-color: var(--accent-dark);
      transform: translateY(-2px);
    }
    
    .btn-outline {
      background-color: transparent;
      color: var(--accent);
      border: 1px solid var(--accent);
      border-radius: 50px;
      padding: 0.5rem 1.5rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: all 0.2s;
    }
    
    .btn-outline:hover {
      background-color: rgba(138, 167, 161, 0.1);
    }
    
    .link {
      color: var(--accent);
      text-decoration: none;
    }
    
    .link:hover {
      text-decoration: underline;
    }
    
    a.text-accent {
      color: var(--accent);
      text-decoration: none;
    }
    
    a.text-accent:hover {
      text-decoration: underline;
    }
    
    input[type="text"],
    input[type="email"],
    textarea,
    select {
      width: 100%;
      background-color: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0.5rem 1rem;
      color: var(--text-main);
      font-family: inherit;
      font-size: 1rem;
    }
    
    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent);
    }
    
    .w-full { width: 100%; }
    .block { display: block; }
    .flex { display: flex; }
    .items-center { align-items: center; }
    .items-start { align-items: flex-start; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-3 { gap: 0.75rem; }
    .gap-4 { gap: 1rem; }
    .flex-wrap { flex-wrap: wrap; }
    
    .font-serif { font-family: Georgia, "Times New Roman", serif; }
    .font-semibold { font-weight: 600; }
    .italic { font-style: italic; }
    .leading-relaxed { line-height: 1.7; }
    
    .opacity-50 { opacity: 0.5; }
    .bg-transparent { background-color: transparent; }
    
    .border { border: 1px solid; }
    .border-t { border-top: 1px solid; }
    .border-b { border-bottom: 1px solid; }
    .border-border { border-color: var(--border); }
    .border-accent { border-color: var(--accent); }
    .rounded-lg { border-radius: 8px; }
    .rounded-full { border-radius: 50px; }
    
    .fixed { position: fixed; }
    .bottom-8 { bottom: 2rem; }
    .right-8 { right: 2rem; }
    .w-12 { width: 3rem; }
    .h-12 { height: 3rem; }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    
    .bg-bg\/30 { background-color: rgba(47, 47, 47, 0.3); }
    
    @media (max-width: 700px) {
      h1 { font-size: 1.8rem; }
      .text-4xl { font-size: 1.8rem; }
    }
  </style>
</head>
<body>
  <header class="text-center py-20 container" role="banner">
    <h1 class="text-4xl font-serif mb-4">Come home. Be still. Listen.</h1>
    <p class="text-muted text-lg mb-4">A gentle invitation to rediscover the One who quietly holds you.</p>
    <p class="italic mb-8">"Be still, and know that I am God." â€” Psalm 46:10</p>
    <p><a href="#stories" class="btn">Begin</a></p>
  </header>

  <section id="stories" class="section container">
    <h2 class="text-2xl font-serif mb-4">Stories That Still Speak</h2>
    <p class="text-lg">From Genesis to Revelation, true stories that point to God's steady love.</p>
  </section>

  <section id="mysticism" class="section container">
    <h2 class="text-2xl font-serif mb-4">A Word on Wandering</h2>
    <p class="text-lg leading-relaxed">Modern ways of self-exaltation promise power but leave the soul thirsty. We point instead toward humility, repentance, and rest.</p>
  </section>

  <section id="testimonies" class="section container">
    <h2 class="text-2xl font-serif mb-4">Real Stories</h2>
    <p class="text-lg leading-relaxed mb-8">Accounts of redemption and the quiet work of grace in ordinary lives.</p>
    
    <!-- Example Story -->
    <div class="story-card card mb-8">
      <h3 class="text-xl font-serif mb-3">From Searching to Finding Peace</h3>
      <p class="text-muted text-sm mb-4">Shared by the Creative Calling team</p>
      <div class="space-y-4 leading-relaxed">
        <p>
          For years, I searched for meaning in all the wrong places â€” in achievements, in others' approval, 
          in spiritual practices that promised power and enlightenment. Each path left me more empty than before.
        </p>
        <p>
          One quiet evening, exhausted from striving, I simply prayed: "God, if You're real, please show me." 
          What followed wasn't dramatic â€” no lightning, no visions. Just a gentle sense of being known, 
          loved, and invited home.
        </p>
        <p>
          Through reading Scripture and learning about Jesus, I discovered that what I'd been searching for 
          had been searching for me all along. The God who created the universe cared about my restless heart. 
          The peace I'd been chasing was found in simply resting in His presence.
        </p>
        <p class="italic">
          "Come to me, all who labor and are heavy laden, and I will give you rest." â€” Matthew 11:28
        </p>
      </div>
    </div>

    <!-- Story Submission Section -->
    <div class="mt-12 pt-8 border-t border-border">
      <h3 class="text-xl font-serif mb-4">Share Your Story</h3>
      <p class="text-lg mb-6">Have you experienced God's grace in your life? We'd love to hear your story. All submissions are reviewed before being shared.</p>
      
      <form id="story-form" action="https://formsubmit.co/your@email.com" method="POST" class="space-y-6">
        <!-- FormSubmit configuration -->
        <input type="hidden" name="_subject" value="ðŸ“– New Story Submission">
        <input type="hidden" name="_template" value="box">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_next" value="https://creativecalling.github.io/thank-you">
        <!-- Prevent spam -->
        <input type="text" name="_honey" style="display:none">
        
        <div class="space-y-2">
          <label for="story-name" class="block text-muted font-semibold">Your Name (or how you'd like to be identified)</label>
          <input id="story-name" name="name" type="text" required
                 class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
                 placeholder="e.g., Sarah from Texas, Anonymous, A grateful believer" />
        </div>

        <div class="space-y-2">
          <label for="story-email" class="block text-muted font-semibold">Your Email (for review communication only, not published)</label>
          <input id="story-email" name="email" type="email" required
                 class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
                 placeholder="your.email@example.com" />
        </div>

        <div class="space-y-2">
          <label for="story-title" class="block text-muted font-semibold">Story Title</label>
          <input id="story-title" name="title" type="text" required
                 class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
                 placeholder="e.g., Finding Hope in the Darkness" />
        </div>

        <div class="space-y-2">
          <label for="story-content" class="block text-muted font-semibold">Your Story</label>
          <textarea id="story-content" name="story" rows="10" required
                    class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
                    placeholder="Share your testimony... How did you encounter God's grace? What changed in your life? What would you want others to know?"></textarea>
          <p class="text-small text-muted">Please share authentically. We value genuine experiences over polished narratives.</p>
        </div>

        <div class="space-y-2">
          <label for="story-verse" class="block text-muted font-semibold">Meaningful Scripture (optional)</label>
          <input id="story-verse" name="scripture" type="text"
                 class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
                 placeholder="e.g., Psalm 23:1-3, Romans 8:28" />
        </div>

        <div class="card bg-bg/30 p-4">
          <div class="flex items-start gap-3">
            <input type="checkbox" id="story-consent" name="consent" class="mt-1" required>
            <label for="story-consent" class="text-small">
              I understand that my story will be reviewed for content and may be shared on this website 
              to encourage others. My email address will not be published.
            </label>
          </div>
        </div>

        <div class="flex gap-4 flex-wrap">
          <button type="submit" class="btn">Submit Story</button>
          <button type="reset" class="btn bg-transparent border border-accent text-accent hover:bg-accent/10">Clear Form</button>
        </div>
      </form>
    </div>
  </section>

  <section id="resources" class="section container">
    <h2 class="text-2xl font-serif mb-6">Resources</h2>
    <ul class="space-y-8">
      <li>
        <a href="https://www.mardel.com/bibletranslationguide" 
           target="_blank" 
           rel="noopener"
           class="text-accent text-lg font-semibold hover:underline">Bible Translation Guide</a>
        <p class="text-muted mt-2">Start here! A helpful guide explaining different Bible translations, their reading levels, and translation philosophies to help you choose the right Bible for your needs.</p>
      </li>
      <li>
        <a href="https://www.youversion.com/the-bible-app/" 
           target="_blank" 
           rel="noopener"
           class="text-accent text-lg font-semibold hover:underline">YouVersion Bible App</a>
        <p class="text-muted mt-2">Free Bible app with multiple translations, reading plans, and daily devotionals. Available on all devices.</p>
      </li>
      <li>
        <a href="https://www.blueletterbible.org/" 
           target="_blank" 
           rel="noopener"
           class="text-accent text-lg font-semibold hover:underline">Blue Letter Bible</a>
        <p class="text-muted mt-2">In-depth study tool with Greek/Hebrew lexicon, commentaries, and cross-references. Great for word studies.</p>
      </li>
      <li>
        <a href="https://www.logos.com/" 
           target="_blank" 
           rel="noopener"
           class="text-accent text-lg font-semibold hover:underline">Logos Bible Software</a>
        <p class="text-muted mt-2">Professional Bible study software with extensive library options, original language tools, and academic resources.</p>
      </li>
    </ul>
  </section>

  <section id="prayer" class="section container">
    <h2 class="text-2xl font-serif mb-4">Need Prayer?</h2>
    <p class="text-lg mb-8">Fill out the short prompts below and we'll help you shape a prayer. Your prayer stays in your browser â€” nothing is sent to a server.</p>

    <form id="prayer-form" action="https://formsubmit.co/your@email.com" method="POST" class="space-y-6">
      <!-- FormSubmit configuration -->
      <input type="hidden" name="_subject" value="ðŸ™ New Prayer Request">
      <input type="hidden" name="_template" value="box">
      <input type="hidden" name="_captcha" value="false">
      <input type="hidden" name="_next" value="https://creativecalling.github.io/thank-you">
      <!-- Prevent spam -->
      <input type="text" name="_honey" style="display:none">
      
      <div class="space-y-2">
        <label for="who" class="block text-muted font-semibold">Who or what is this prayer for?</label>
        <input id="who" name="who" type="text" required
               class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
               placeholder="e.g., myself, my friend Anna, my family" />
      </div>

      <div class="space-y-2">
        <label for="need" class="block text-muted font-semibold">What is the need or concern?</label>
        <input id="need" name="need" type="text" required
               class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
               placeholder="e.g., healing, wisdom, provision" />
      </div>

      <div class="space-y-2">
        <label for="feeling" class="block text-muted font-semibold">How are you feeling about this?</label>
        <input id="feeling" name="feeling" type="text" required
               class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
               placeholder="e.g., anxious, grateful, confused" />
      </div>

      <div class="space-y-2">
        <label for="promise" class="block text-muted font-semibold">Is there a Bible promise or hope you'd lean on (optional)?</label>
        <input id="promise" name="promise" type="text" 
               class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
               placeholder="e.g., God's presence, Psalm 23, peace beyond understanding" />
      </div>

      <div class="space-y-2">
        <label for="email" class="block text-muted font-semibold">Your Email (for follow-up communication only)</label>
        <input id="email" name="email" type="email" 
               class="w-full bg-bg border border-border rounded-lg px-4 py-2" 
               placeholder="your.email@example.com" />
        <p class="text-small text-muted">We'll use this to send you a secure way to communicate about your prayer request.</p>
      </div>

      <!-- Secure communication token field -->
      <input type="hidden" name="prayer_token" id="prayer_token">

      <div class="card bg-bg/30 p-4">
        <div class="flex items-start gap-3">
          <input type="checkbox" id="share-prayer" name="request_followup" class="mt-1" required>
          <label for="share-prayer" class="text-small">
            Yes, I would like prayer support and follow-up. I understand that my request will be kept confidential 
            and I'll receive a secure way to communicate back and forth about my prayer request.
          </label>
        </div>
      </div>

      <div class="flex gap-4 flex-wrap">
        <button type="button" id="preview-btn" class="btn">Preview Prayer</button>
        <button type="button" id="copy-btn" class="btn opacity-50" disabled>Copy Prayer</button>
        <button type="submit" id="send-btn" class="btn-outline">Submit Prayer Request</button>
        <button type="reset" id="reset-btn" class="btn bg-transparent border border-accent text-accent hover:bg-accent/10">Reset</button>
      </div>
    </form>

    <div id="prayer-preview" class="card mt-8" aria-live="polite" hidden>
      <h3 class="text-xl font-serif mb-4">Your Prayer</h3>
      <blockquote id="prayer-text" class="text-lg leading-relaxed italic"></blockquote>
    </div>

    <!-- Prayer Management Section (only visible to you) -->
    <div id="prayer-management" class="mt-12 border-t border-border pt-8" hidden>
      <h3 class="text-2xl font-serif mb-4">Prayer Management</h3>
      <div class="grid gap-6" id="prayer-list"></div>

      <template id="prayer-card-template">
        <div class="card">
          <div class="flex justify-between items-start mb-4">
            <div>
              <h4 class="text-lg font-semibold"></h4>
              <p class="text-muted text-sm date"></p>
            </div>
            <span class="status-badge px-3 py-1 rounded-full text-sm"></span>
          </div>
          <div class="space-y-2 mb-4">
            <p class="need"></p>
            <p class="text-muted feeling"></p>
            <p class="promise italic"></p>
          </div>
          <div class="space-y-4">
            <div class="response-area hidden">
              <label class="block text-muted font-semibold mb-2">Your Response:</label>
              <textarea class="response-text w-full bg-bg border border-border rounded-lg px-4 py-2" 
                        rows="4" placeholder="Write your prayer and thoughts here..."></textarea>
            </div>
            <div class="flex gap-3 flex-wrap">
              <button class="btn-outline respond-btn">Respond</button>
              <button class="btn-outline follow-up-btn">Send Follow-up</button>
              <button class="btn-outline mark-completed-btn">Mark Complete</button>
            </div>
          </div>
        </div>
      </template>
    </div>

    <script>
      (function(){
        // DOM Elements
        const prayerForm = document.getElementById('prayer-form');
        const previewBtn = document.getElementById('preview-btn');
        const copyBtn = document.getElementById('copy-btn');
        const prayerTextEl = document.getElementById('prayer-text');
        const previewWrap = document.getElementById('prayer-preview');
        const tokenInput = document.getElementById('prayer_token');

        // Prayer templates for different situations
        const prayerTemplates = {
          praise: [
            "We praise You for Your faithfulness that never fails.",
            "Your love endures forever, and Your mercies are new every morning.",
            "You are our rock and our fortress, our ever-present help in times of need."
          ],
          comfort: [
            "May Your peace that surpasses all understanding guard their heart and mind.",
            "Let them feel Your presence in a tangible way today.",
            "Wrap them in Your comfort as a shepherd carries a lamb."
          ],
          guidance: [
            "Light their path with Your wisdom and truth.",
            "Show them Your way and guide their steps.",
            "Grant them discernment to know Your will."
          ],
          healing: [
            "We ask for Your healing touch, both physically and spiritually.",
            "Restore what is broken and bring wholeness where there is pain.",
            "Let Your healing presence flow through every part of their being."
          ]
        };

        function getEmotionalResponse(feeling) {
          const emotions = {
            anxious: ["peace that surpasses understanding", "calm in the storm", "rest in Your presence"],
            worried: ["trust in Your provision", "confidence in Your care", "freedom from fear"],
            grateful: ["continued thankfulness", "joy in Your goodness", "appreciation of Your blessings"],
            hopeful: ["strengthened faith", "renewed spirit", "continued hope in Your promises"],
            sad: ["comfort in sorrow", "joy in the morning", "healing for the heartbroken"],
            confused: ["clarity of mind", "wisdom for decisions", "understanding of Your will"]
          };

          // Find the best matching emotion or default to general comfort
          const match = Object.entries(emotions).find(([key]) => 
            feeling.toLowerCase().includes(key)
          );
          return match ? match[1][Math.floor(Math.random() * match[1].length)] : "peace and clarity";
        }

        function composePrayer(values){
          const who = values.who || 'this person';
          const need = values.need || '';
          const feeling = values.feeling || '';
          const promise = values.promise || '';

          const lines = [];
          
          // Opening
          lines.push(`Loving Father,`);
          
          // Random praise element
          lines.push(prayerTemplates.praise[Math.floor(Math.random() * prayerTemplates.praise.length)]);

          // Main prayer content
          if (who) {
            lines.push(`We lift up ${who} to You today.`);
          }

          if (feeling) {
            const emotionalResponse = getEmotionalResponse(feeling);
            lines.push(`As they experience ${feeling}, we pray for ${emotionalResponse}.`);
            lines.push(prayerTemplates.comfort[Math.floor(Math.random() * prayerTemplates.comfort.length)]);
          }

          if (need) {
            lines.push(`We specifically ask for ${need}.`);
            if (need.toLowerCase().includes('heal')) {
              lines.push(prayerTemplates.healing[Math.floor(Math.random() * prayerTemplates.healing.length)]);
            } else {
              lines.push(prayerTemplates.guidance[Math.floor(Math.random() * prayerTemplates.guidance.length)]);
            }
          }

          // Biblical promise or hope
          if (promise) {
            lines.push(`We stand on Your promise of ${promise}, knowing that You are faithful to fulfill Your word.`);
          }

          // Closing
          lines.push(`Thank You for hearing our prayer and for Your constant love that surrounds ${who}.`);
          lines.push('In Jesus\' name, amen.');

          return lines.join('\n\n');
        }

        previewBtn.addEventListener('click', function(){
          const data = new FormData(form);
          const values = Object.fromEntries(data.entries());
          const prayer = composePrayer(values).trim();
          prayerTextEl.textContent = prayer;
          previewWrap.hidden = false;
          copyBtn.disabled = false;
        });

        copyBtn.addEventListener('click', function(){
          const text = prayerTextEl.textContent;
          if(!text) return;
          navigator.clipboard && navigator.clipboard.writeText(text).then(function(){
            copyBtn.textContent = 'Copied';
            setTimeout(()=> copyBtn.textContent = 'Copy Prayer', 2000);
          }, function(){
            // fallback
            const ta = document.createElement('textarea');
            ta.value = text; document.body.appendChild(ta); ta.select();
            try{ document.execCommand('copy'); copyBtn.textContent = 'Copied'; }catch(e){}
            ta.remove();
            setTimeout(()=> copyBtn.textContent = 'Copy Prayer', 2000);
          });
        });

        // Secure prayer request and response management
        const sendBtn = document.getElementById('send-btn');
        const shareCheckbox = document.getElementById('share-prayer');
        const form = document.getElementById('prayer-form');
        const emailInput = document.getElementById('email');

        // Secure prayer request management system
        const PrayerManager = {
          storageKey: 'prayerRequests',
          tokenKey: 'prayerTokens',

          // Generate a secure token for communication
          generateToken() {
            return Array.from(crypto.getRandomValues(new Uint8Array(32)))
              .map(b => b.toString(16).padStart(2, '0'))
              .join('');
          },

          // Store token mapping
          saveToken(requestId, token) {
            const tokens = JSON.parse(localStorage.getItem(this.tokenKey) || '{}');
            tokens[token] = requestId;
            localStorage.setItem(this.tokenKey, JSON.stringify(tokens));
          },

          // Get request by token
          getRequestByToken(token) {
            const tokens = JSON.parse(localStorage.getItem(this.tokenKey) || '{}');
            const requestId = tokens[token];
            if (!requestId) return null;

            const requests = this.getRequests();
            return requests.find(r => r.id === requestId);
          },
          
          // Initialize storage
          init() {
            if (!localStorage.getItem(this.storageKey)) {
              localStorage.setItem(this.storageKey, JSON.stringify([]));
            }
          },

          // Save new prayer request
          saveRequest(request) {
            const requests = this.getRequests();
            request.id = Date.now().toString();
            request.status = 'new';
            request.dateReceived = new Date().toISOString();
            requests.push(request);
            localStorage.setItem(this.storageKey, JSON.stringify(requests));
            return request.id;
          },

          // Get all prayer requests
          getRequests() {
            return JSON.parse(localStorage.getItem(this.storageKey) || '[]');
          },

          // Update prayer request status and response
          updateRequest(id, updates) {
            const requests = this.getRequests();
            const index = requests.findIndex(r => r.id === id);
            if (index !== -1) {
              requests[index] = { ...requests[index], ...updates };
              localStorage.setItem(this.storageKey, JSON.stringify(requests));
            }
          },

          // Format prayer request for email
          formatEmailBody(request, type = 'initial') {
            if (type === 'initial') {
              return encodeURIComponent(
                `New Prayer Request:\n\n` +
                `For: ${request.who}\n` +
                `Need: ${request.need}\n` +
                `Feeling: ${request.feeling}\n` +
                (request.promise ? `Promise claimed: ${request.promise}\n\n` : '\n') +
                `Generated Prayer:\n${request.prayer}\n\n` +
                `Request ID: ${request.id}\n` +
                `Reply to: ${request.email}`
              );
            } else { // follow-up
              return encodeURIComponent(
                `Prayer Follow-up:\n\n` +
                `Dear friend,\n\n` +
                `I wanted to let you know that I've been praying for your request:\n` +
                `"${request.need}"\n\n` +
                `Here's how I've been praying for you:\n` +
                `${request.responseText || '[Add your personal prayer and thoughts here]'}\n\n` +
                `Would you let me know how you're doing? I'm here to continue praying with you.\n\n` +
                `With care,\n[Your name]`
              );
            }
          }
        };

        // Initialize prayer manager
        PrayerManager.init();

        function updateSendButton() {
          const canSend = shareCheckbox.checked && emailInput.value.includes('@');
          sendBtn.disabled = !canSend;
          sendBtn.classList.toggle('opacity-50', !canSend);
        }

        emailInput.addEventListener('input', updateSendButton);
        shareCheckbox.addEventListener('change', updateSendButton);

        // Enhanced send functionality with prayer tracking
        sendBtn.addEventListener('click', async function() {
          if (!shareCheckbox.checked || !emailInput.value) return;

          const formData = new FormData(form);
          const prayer = prayerTextEl.textContent;
          
          // Save prayer request
          const requestData = {
            who: formData.get('who'),
            need: formData.get('need'),
            feeling: formData.get('feeling'),
            promise: formData.get('promise'),
            email: formData.get('email'),
            prayer: prayer
          };

          const requestId = PrayerManager.saveRequest(requestData);
          
          // Create email with tracking ID
          const subject = encodeURIComponent('Prayer Request from Creative Calling');
          const body = PrayerManager.formatEmailBody(requestData);

          // Open email client
          window.location.href = `mailto:your@email.com?subject=${subject}&body=${body}`;

          // Show confirmation
          const originalText = sendBtn.textContent;
          sendBtn.textContent = 'Request Sent!';
          sendBtn.disabled = true;

          // Add response button after sending
          const responseBtn = document.createElement('button');
          responseBtn.className = 'btn-outline';
          responseBtn.textContent = 'Send Follow-up';
          responseBtn.onclick = () => {
            const responseSubject = encodeURIComponent(`Prayer Follow-up - ${requestData.who}`);
            const responseBody = PrayerManager.formatEmailBody(requestData, 'follow-up');
            window.location.href = `mailto:${requestData.email}?subject=${responseSubject}&body=${responseBody}`;
            
            // Update request status
            PrayerManager.updateRequest(requestId, {
              status: 'followed-up',
              lastFollowUp: new Date().toISOString()
            });
          };

          // Add response button to form
          setTimeout(() => {
            sendBtn.parentNode.insertBefore(responseBtn, sendBtn.nextSibling);
            sendBtn.textContent = originalText;
            sendBtn.disabled = false;
          }, 3000);
        });

        form.addEventListener('reset', function(){
          prayerTextEl.textContent = '';
          previewWrap.hidden = true;
          copyBtn.disabled = true;
          sendBtn.disabled = true;
          sendBtn.classList.add('opacity-50');
        });

        // Prayer Management Interface
        const managementSection = document.getElementById('prayer-management');
        const prayerList = document.getElementById('prayer-list');
        const template = document.getElementById('prayer-card-template');

        // Show management section with special key combination (Ctrl+Shift+P)
        document.addEventListener('keydown', function(e) {
          if (e.ctrlKey && e.shiftKey && e.key === 'P') {
            managementSection.hidden = !managementSection.hidden;
            if (!managementSection.hidden) {
              refreshPrayerList();
            }
          }
        });

        function refreshPrayerList() {
          const requests = PrayerManager.getRequests();
          prayerList.innerHTML = '';
          
          requests.sort((a, b) => new Date(b.dateReceived) - new Date(a.dateReceived))
                 .forEach(request => {
            const card = template.content.cloneNode(true);
            
            // Fill in prayer request details
            card.querySelector('h4').textContent = request.who;
            card.querySelector('.date').textContent = new Date(request.dateReceived).toLocaleDateString();
            card.querySelector('.need').textContent = request.need;
            card.querySelector('.feeling').textContent = `Feeling: ${request.feeling}`;
            if (request.promise) {
              card.querySelector('.promise').textContent = `Promise: ${request.promise}`;
            }

            // Set status badge
            const badge = card.querySelector('.status-badge');
            badge.textContent = request.status;
            badge.classList.add(
              request.status === 'new' ? 'bg-accent/20 text-accent' :
              request.status === 'responded' ? 'bg-green-500/20 text-green-500' :
              'bg-muted/20 text-muted'
            );

            // Setup buttons
            const responseArea = card.querySelector('.response-area');
            const responseText = card.querySelector('.response-text');
            const respondBtn = card.querySelector('.respond-btn');
            const followUpBtn = card.querySelector('.follow-up-btn');
            const completeBtn = card.querySelector('.mark-completed-btn');

            respondBtn.onclick = () => {
              responseArea.classList.toggle('hidden');
              if (request.responseText) {
                responseText.value = request.responseText;
              }
            };

            // Save response as you type
            responseText.oninput = () => {
              PrayerManager.updateRequest(request.id, {
                responseText: responseText.value,
                status: 'draft'
              });
            };

            followUpBtn.onclick = () => {
              const responseSubject = encodeURIComponent(`Prayer Follow-up - ${request.who}`);
              const responseBody = PrayerManager.formatEmailBody({
                ...request,
                responseText: responseText.value
              }, 'follow-up');
              
              window.location.href = `mailto:${request.email}?subject=${responseSubject}&body=${responseBody}`;
              
              PrayerManager.updateRequest(request.id, {
                status: 'responded',
                lastFollowUp: new Date().toISOString(),
                responseText: responseText.value
              });

              refreshPrayerList();
            };

            completeBtn.onclick = () => {
              PrayerManager.updateRequest(request.id, {
                status: 'completed',
                dateCompleted: new Date().toISOString()
              });
              refreshPrayerList();
            };

            prayerList.appendChild(card);
          });
        }
      })();
    </script>
  </section>

  <footer class="container py-12">
    <div class="text-center space-y-4">
      <p class="text-small">Â© 2025 Creative Calling â€” A quiet path home</p>
      <div class="flex justify-center gap-4">
        <a href="#stories" class="link text-small">Stories</a>
        <a href="#mysticism" class="link text-small">Wandering</a>
        <a href="#testimonies" class="link text-small">Testimonies</a>
        <a href="#resources" class="link text-small">Resources</a>
      </div>
    </div>
  </footer>

  <!-- Back to top button -->
  <button 
    onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
    class="fixed bottom-8 right-8 bg-accent/90 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-lg hover:bg-accent transition-colors"
    aria-label="Scroll to top">
    â†‘
  </button>
</body>
</html>